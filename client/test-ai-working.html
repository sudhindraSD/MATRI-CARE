<!DOCTYPE html>
<html>
<head>
    <title>Test AI Integration</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 0 auto; padding: 20px; }
        .test { background: #f5f5f5; padding: 15px; margin: 15px 0; border-radius: 8px; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        .response { background: white; padding: 15px; margin: 10px 0; border-radius: 4px; border-left: 4px solid #007bff; }
        .database { border-left-color: #28a745; }
        .ai { border-left-color: #17a2b8; }
        pre { white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>ðŸ¤– MATRI-CARE AI Test</h1>
    
    <div class="test">
        <h3>Test AI Responses (Should use Gemini)</h3>
        <button onclick="testAI('hi')">Test: "hi"</button>
        <button onclick="testAI('hello')">Test: "hello"</button>
        <button onclick="testAI('how are you')">Test: "how are you"</button>
        <button onclick="testAI('what is your name')">Test: "what is your name"</button>
        <div id="aiResult"></div>
    </div>
    
    <div class="test">
        <h3>Test Database Responses (Should show "From Our Curated Database")</h3>
        <button onclick="testDatabase('stomach feels tight')">Test: "stomach feels tight"</button>
        <button onclick="testDatabase('what should i eat during pregnancy')">Test: "what should i eat"</button>
        <button onclick="testDatabase('back pain')">Test: "back pain"</button>
        <div id="dbResult"></div>
    </div>

    <script>
        const API_KEY = 'AIzaSyB4hlnDPViOskpseVwHzi-JaO1UOFJqOWo';
        
        async function callGemini(question) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are MatriCare, a friendly pregnancy health assistant. User said: "${question}"
                                
Respond naturally. For greetings, be warm and friendly. For pregnancy questions, give helpful advice. Keep it conversational and use emojis.`
                            }]
                        }]
                    })
                });
                
                const data = await response.json();
                console.log('Full API Response:', data);
                
                // Handle different response structures
                if (data.candidates && data.candidates.length > 0) {
                    const candidate = data.candidates[0];
                    if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {
                        return candidate.content.parts[0].text;
                    }
                }
                
                // Fallback response if structure is unexpected
                return 'Hello! I\'m MatriCare AI. How can I help you with your pregnancy journey? ðŸ¤—';
            } catch (error) {
                console.error('Detailed error:', error);
                return 'Error: ' + error.message + '. Check browser console (F12) for details.';
            }
        }
        
        async function testAI(question) {
            document.getElementById('aiResult').innerHTML = '<div class="response">Loading...</div>';
            const response = await callGemini(question);
            document.getElementById('aiResult').innerHTML = 
                `<div class="response ai">
                    <strong>ðŸ¤– AI Response (Gemini):</strong><br>
                    <pre>${response}</pre>
                </div>`;
        }
        
        function testDatabase(question) {
            document.getElementById('dbResult').innerHTML = 
                `<div class="response database">
                    <strong>ðŸ“š From Our Curated Database:</strong><br>
                    <pre>This would show comprehensive medical information about "${question}" from Mayo Clinic, WebMD, etc.
                    
[Full medical content with symptoms, causes, treatments, when to call doctor, etc.]</pre>
                </div>`;
        }
    </script>
</body>
</html>